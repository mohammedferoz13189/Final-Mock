<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-NFLMNZZ2');</script>
<!-- End Google Tag Manager -->
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L0349CZYK1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L0349CZYK1');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LUXE MARKET ‚Äî Premium Shopping</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">

<!-- ============================================================ -->
<!--  GOOGLE TAG MANAGER & DATA LAYER INITIALIZATION              -->
<!--  Replace GTM-XXXXXXX with your actual GTM Container ID       -->
<!-- ============================================================ -->
<script>
  // Initialize dataLayer BEFORE GTM loads (GA4 / GTM best practice)
  window.dataLayer = window.dataLayer || [];

  // ‚îÄ‚îÄ Site-wide context pushed on page load ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  window.dataLayer.push({
    event: 'site_config',
    site: {
      name: 'LuxeMarket',
      version: '2.0.0',
      currency: 'USD',
      locale: 'en-US',
      environment: 'production'
    }
  });
</script>

<!-- Google Tag Manager (replace GTM-XXXXXXX with real ID) -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-XXXXXXX');</script>
<!-- End Google Tag Manager -->
<style>
  :root {
    --bg: #0a0a0a;
    --surface: #141414;
    --surface2: #1e1e1e;
    --border: #2a2a2a;
    --gold: #c9a84c;
    --gold2: #e8c96a;
    --text: #f0ebe3;
    --muted: #888;
    --accent: #c9a84c;
    --danger: #e05252;
    --success: #52c472;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-weight: 300;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* ===== PAGES ===== */
  .page { display: none; animation: fadeIn 0.4s ease; }
  .page.active { display: block; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

  /* ===== HEADER ===== */
  header {
    position: fixed; top: 0; left: 0; right: 0;
    z-index: 1000;
    background: rgba(10,10,10,0.92);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 60px;
    height: 70px;
  }

  .logo {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.8rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    color: var(--gold);
    cursor: pointer;
    text-decoration: none;
  }
  .logo span { color: var(--text); font-weight: 300; }

  nav { display: flex; gap: 36px; align-items: center; }
  nav a {
    color: var(--muted);
    text-decoration: none;
    font-size: 0.8rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    transition: color 0.2s;
  }
  nav a:hover, nav a.active { color: var(--gold); }

  .header-right { display: flex; gap: 20px; align-items: center; }

  .cart-btn {
    position: relative;
    background: var(--gold);
    color: #000;
    border: none;
    padding: 9px 22px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.78rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 500;
    transition: background 0.2s, transform 0.1s;
  }
  .cart-btn:hover { background: var(--gold2); transform: translateY(-1px); }

  .cart-count {
    position: absolute;
    top: -8px; right: -8px;
    background: var(--danger);
    color: #fff;
    border-radius: 50%;
    width: 20px; height: 20px;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.7rem;
    font-weight: 700;
  }

  /* ===== HERO ===== */
  .hero {
    padding-top: 70px;
    min-height: 100vh;
    display: grid;
    grid-template-columns: 1fr 1fr;
    position: relative;
    overflow: hidden;
  }

  .hero-left {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 80px 60px;
    position: relative;
    z-index: 2;
  }

  .hero-tag {
    font-size: 0.72rem;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 24px;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .hero-tag::before { content: ''; display: inline-block; width: 40px; height: 1px; background: var(--gold); }

  .hero h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(3rem, 6vw, 6.5rem);
    font-weight: 300;
    line-height: 1.05;
    margin-bottom: 28px;
  }
  .hero h1 em { font-style: italic; color: var(--gold); }

  .hero p {
    color: var(--muted);
    font-size: 1rem;
    line-height: 1.8;
    max-width: 420px;
    margin-bottom: 48px;
  }

  .hero-btns { display: flex; gap: 16px; }

  .btn-primary {
    background: var(--gold);
    color: #000;
    border: none;
    padding: 16px 40px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
  }
  .btn-primary:hover { background: var(--gold2); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(201,168,76,0.3); }

  .btn-outline {
    background: transparent;
    color: var(--text);
    border: 1px solid var(--border);
    padding: 16px 40px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn-outline:hover { border-color: var(--gold); color: var(--gold); }

  .hero-right {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }

  .hero-visual {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #1a1508 0%, #2d2010 50%, #1a1508 100%);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .hero-img-placeholder {
    width: 380px;
    height: 500px;
    background: linear-gradient(160deg, var(--surface) 0%, var(--surface2) 100%);
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    position: relative;
    overflow: hidden;
  }
  .hero-img-placeholder::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: conic-gradient(transparent, rgba(201,168,76,0.05), transparent);
    animation: spin 8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .hero-product-icon {
    font-size: 4rem;
    filter: grayscale(0.3);
  }

  .hero-badge {
    position: absolute;
    top: 30px; right: 30px;
    background: var(--gold);
    color: #000;
    padding: 10px 16px;
    font-size: 0.72rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  /* ===== MARQUEE ===== */
  .marquee-wrap {
    border-top: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    overflow: hidden;
    padding: 14px 0;
    background: var(--surface);
  }
  .marquee {
    display: flex;
    gap: 60px;
    animation: marquee 20s linear infinite;
    white-space: nowrap;
  }
  .marquee span {
    font-size: 0.72rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--muted);
    flex-shrink: 0;
  }
  .marquee span.dot { color: var(--gold); }
  @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

  /* ===== SECTION ===== */
  section {
    padding: 80px 60px;
  }

  .section-header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    margin-bottom: 48px;
  }

  .section-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2rem, 4vw, 3.5rem);
    font-weight: 300;
  }
  .section-title em { font-style: italic; color: var(--gold); }

  .section-link {
    color: var(--gold);
    text-decoration: none;
    font-size: 0.78rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    cursor: pointer;
    border-bottom: 1px solid currentColor;
    padding-bottom: 2px;
    transition: opacity 0.2s;
  }
  .section-link:hover { opacity: 0.7; }

  /* ===== PRODUCTS GRID ===== */
  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 2px;
  }

  .product-card {
    background: var(--surface);
    cursor: pointer;
    transition: transform 0.3s;
    position: relative;
    overflow: hidden;
    border: 1px solid var(--border);
  }
  .product-card:hover { transform: translateY(-4px); }
  .product-card:hover .product-overlay { opacity: 1; }

  .product-img {
    height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 5rem;
    background: var(--surface2);
    position: relative;
    overflow: hidden;
  }

  .product-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .quick-add {
    background: var(--gold);
    color: #000;
    border: none;
    padding: 12px 28px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.78rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 500;
    transition: background 0.2s;
  }
  .quick-add:hover { background: var(--gold2); }

  .product-info { padding: 20px; }

  .product-category {
    font-size: 0.68rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 6px;
  }

  .product-name {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 8px;
    letter-spacing: 0.03em;
  }

  .product-price {
    font-size: 1.1rem;
    color: var(--gold);
    font-weight: 500;
  }
  .product-price del { color: var(--muted); font-size: 0.9rem; margin-left: 8px; }

  .product-badge {
    position: absolute;
    top: 14px; left: 14px;
    background: var(--danger);
    color: #fff;
    font-size: 0.65rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 4px 10px;
    font-weight: 700;
  }

  /* ===== FEATURES STRIP ===== */
  .features-strip {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2px;
    background: var(--border);
    border: 1px solid var(--border);
  }
  .feature-item {
    background: var(--surface);
    padding: 36px 28px;
    display: flex;
    gap: 16px;
    align-items: flex-start;
  }
  .feature-icon { font-size: 1.8rem; flex-shrink: 0; }
  .feature-title { font-family: 'Cormorant Garamond', serif; font-size: 1.1rem; font-weight: 600; margin-bottom: 4px; }
  .feature-desc { font-size: 0.82rem; color: var(--muted); line-height: 1.6; }

  /* ===== NEWSLETTER ===== */
  .newsletter {
    text-align: center;
    padding: 100px 60px;
    background: var(--surface);
    border-top: 1px solid var(--border);
  }
  .newsletter h2 {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2.5rem, 4vw, 4rem);
    font-weight: 300;
    margin-bottom: 16px;
  }
  .newsletter p { color: var(--muted); margin-bottom: 36px; }
  .newsletter-form {
    display: flex;
    gap: 0;
    max-width: 480px;
    margin: 0 auto 12px;
  }
  .nl-input {
    flex: 1;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-right: none;
    padding: 14px 20px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem;
    outline: none;
  }
  .nl-input:focus { border-color: var(--gold); }
  .nl-btn {
    background: var(--gold);
    color: #000;
    border: none;
    padding: 14px 28px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.78rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 500;
    transition: background 0.2s;
  }
  .nl-btn:hover { background: var(--gold2); }
  .nl-success { color: var(--success); font-size: 0.85rem; display: none; }

  /* ===== FOOTER ===== */
  footer {
    background: var(--surface);
    border-top: 1px solid var(--border);
    padding: 60px 60px 30px;
  }
  .footer-grid {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 48px;
    margin-bottom: 48px;
  }
  .footer-brand .logo { display: block; margin-bottom: 16px; }
  .footer-brand p { font-size: 0.85rem; color: var(--muted); line-height: 1.8; max-width: 300px; }
  .footer-col h4 {
    font-size: 0.72rem;
    letter-spacing: 0.2em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 20px;
    font-weight: 500;
  }
  .footer-col a {
    display: block;
    color: var(--muted);
    text-decoration: none;
    font-size: 0.87rem;
    margin-bottom: 10px;
    cursor: pointer;
    transition: color 0.2s;
  }
  .footer-col a:hover { color: var(--text); }
  .footer-bottom {
    border-top: 1px solid var(--border);
    padding-top: 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.78rem;
    color: var(--muted);
  }
  .footer-bottom a { color: var(--gold); text-decoration: none; }

  /* ===== CART PAGE ===== */
  .page-hero {
    padding-top: 70px;
    padding: 120px 60px 40px;
    border-bottom: 1px solid var(--border);
  }
  .page-hero h1 {
    font-family: 'Cormorant Garamond', serif;
    font-size: clamp(2.5rem, 5vw, 4.5rem);
    font-weight: 300;
  }
  .page-hero p { color: var(--muted); margin-top: 8px; }

  .cart-layout {
    display: grid;
    grid-template-columns: 1fr 380px;
    gap: 40px;
    padding: 48px 60px;
    align-items: start;
  }

  .cart-items {}

  .cart-item {
    display: grid;
    grid-template-columns: 100px 1fr auto;
    gap: 24px;
    align-items: center;
    padding: 24px 0;
    border-bottom: 1px solid var(--border);
    animation: fadeIn 0.3s ease;
  }

  .cart-item-img {
    width: 100px;
    height: 100px;
    background: var(--surface2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    border: 1px solid var(--border);
  }

  .cart-item-name {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 4px;
  }
  .cart-item-cat { font-size: 0.75rem; color: var(--gold); letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 12px; }
  .cart-item-price { font-size: 1.05rem; color: var(--gold); }

  .qty-control {
    display: flex;
    align-items: center;
    gap: 0;
    border: 1px solid var(--border);
    width: fit-content;
    margin-top: 12px;
  }
  .qty-btn {
    background: transparent;
    border: none;
    color: var(--text);
    width: 36px;
    height: 36px;
    cursor: pointer;
    font-size: 1.1rem;
    transition: background 0.2s;
  }
  .qty-btn:hover { background: var(--surface2); }
  .qty-num {
    width: 40px;
    text-align: center;
    font-size: 0.9rem;
    border: none;
    border-left: 1px solid var(--border);
    border-right: 1px solid var(--border);
    height: 36px;
    background: transparent;
    color: var(--text);
    outline: none;
  }

  .cart-item-actions { display: flex; flex-direction: column; align-items: flex-end; gap: 12px; }
  .remove-btn {
    background: transparent;
    border: none;
    color: var(--muted);
    cursor: pointer;
    font-size: 0.8rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    transition: color 0.2s;
  }
  .remove-btn:hover { color: var(--danger); }
  .item-total { font-size: 1.1rem; font-weight: 500; }

  /* Cart Summary */
  .cart-summary {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 36px;
    position: sticky;
    top: 90px;
  }
  .summary-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.6rem;
    margin-bottom: 28px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }
  .summary-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 14px;
    font-size: 0.9rem;
  }
  .summary-row .label { color: var(--muted); }
  .summary-total {
    display: flex;
    justify-content: space-between;
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
  }
  .summary-total .gold { color: var(--gold); }

  .promo-section { margin: 24px 0; }
  .promo-label { font-size: 0.75rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 8px; }
  .promo-row { display: flex; gap: 0; }
  .promo-input {
    flex: 1;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-right: none;
    padding: 10px 14px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    outline: none;
  }
  .promo-input:focus { border-color: var(--gold); }
  .promo-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--gold);
    padding: 10px 16px;
    cursor: pointer;
    font-size: 0.78rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    transition: background 0.2s;
    font-family: 'DM Sans', sans-serif;
  }
  .promo-btn:hover { background: var(--border); }
  .promo-msg { font-size: 0.78rem; margin-top: 6px; }
  .promo-msg.good { color: var(--success); }
  .promo-msg.bad { color: var(--danger); }

  .checkout-btn {
    display: block;
    width: 100%;
    background: var(--gold);
    color: #000;
    border: none;
    padding: 18px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 600;
    margin-top: 24px;
    transition: all 0.2s;
  }
  .checkout-btn:hover { background: var(--gold2); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(201,168,76,0.25); }

  .secure-note { text-align: center; font-size: 0.75rem; color: var(--muted); margin-top: 16px; }

  .empty-cart {
    text-align: center;
    padding: 80px 20px;
    grid-column: 1 / -1;
  }
  .empty-cart .big-icon { font-size: 5rem; margin-bottom: 20px; opacity: 0.4; }
  .empty-cart h3 { font-family: 'Cormorant Garamond', serif; font-size: 2rem; font-weight: 300; margin-bottom: 12px; }
  .empty-cart p { color: var(--muted); margin-bottom: 32px; }

  /* ===== SHOP PAGE ===== */
  .shop-layout {
    display: grid;
    grid-template-columns: 240px 1fr;
    gap: 48px;
    padding: 48px 60px;
  }

  .shop-filters {}
  .filter-group { margin-bottom: 32px; }
  .filter-title {
    font-size: 0.72rem;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 16px;
    font-weight: 500;
  }
  .filter-item {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    cursor: pointer;
  }
  .filter-item input[type="checkbox"] {
    accent-color: var(--gold);
    width: 14px;
    height: 14px;
    cursor: pointer;
  }
  .filter-item label { font-size: 0.88rem; color: var(--muted); cursor: pointer; transition: color 0.2s; }
  .filter-item:hover label { color: var(--text); }

  .price-range { display: flex; flex-direction: column; gap: 10px; }
  .range-input {
    width: 100%;
    accent-color: var(--gold);
  }
  .range-labels { display: flex; justify-content: space-between; font-size: 0.78rem; color: var(--muted); }

  .sort-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 28px;
  }
  .results-count { font-size: 0.85rem; color: var(--muted); }
  .sort-select {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 8px 14px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    outline: none;
    cursor: pointer;
  }

  /* ===== CHECKOUT PAGE ===== */
  .checkout-layout {
    display: grid;
    grid-template-columns: 1fr 380px;
    gap: 40px;
    padding: 48px 60px;
    align-items: start;
  }

  .checkout-form {}

  .form-section { margin-bottom: 40px; }
  .form-section-title {
    font-family: 'Cormorant Garamond', serif;
    font-size: 1.4rem;
    margin-bottom: 24px;
    padding-bottom: 12px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .form-section-num {
    width: 28px; height: 28px;
    background: var(--gold);
    color: #000;
    font-size: 0.78rem;
    font-weight: 700;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 16px; }
  .form-row.full { grid-template-columns: 1fr; }
  .form-row.three { grid-template-columns: 1fr 1fr 1fr; }

  .form-group { display: flex; flex-direction: column; gap: 6px; }
  .form-label {
    font-size: 0.72rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--muted);
  }
  .form-input {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem;
    outline: none;
    transition: border-color 0.2s;
  }
  .form-input:focus { border-color: var(--gold); }
  .form-input::placeholder { color: var(--muted); }

  .form-select {
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px 16px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.9rem;
    outline: none;
    transition: border-color 0.2s;
    appearance: none;
    cursor: pointer;
  }

  /* Payment Methods */
  .payment-methods { display: flex; gap: 12px; margin-bottom: 20px; }
  .payment-method {
    flex: 1;
    border: 1px solid var(--border);
    padding: 14px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s;
    position: relative;
  }
  .payment-method.selected { border-color: var(--gold); background: rgba(201,168,76,0.08); }
  .payment-method input[type="radio"] { position: absolute; opacity: 0; }
  .payment-method label { cursor: pointer; font-size: 0.82rem; display: flex; flex-direction: column; align-items: center; gap: 6px; }
  .payment-icon { font-size: 1.5rem; }

  .card-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

  .paypal-section { text-align: center; padding: 24px; border: 1px solid var(--border); background: var(--surface2); }
  .paypal-btn {
    background: #0070ba;
    color: #fff;
    border: none;
    padding: 14px 40px;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    border-radius: 4px;
    transition: background 0.2s;
  }
  .paypal-btn:hover { background: #005ea6; }

  /* Order Summary Sidebar */
  .order-summary {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 36px;
    position: sticky;
    top: 90px;
  }
  .order-item {
    display: flex;
    gap: 14px;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }
  .order-item-img {
    width: 56px; height: 56px;
    background: var(--surface2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    flex-shrink: 0;
    border: 1px solid var(--border);
  }
  .order-item-name { font-size: 0.88rem; margin-bottom: 2px; }
  .order-item-qty { font-size: 0.75rem; color: var(--muted); }
  .order-item-price { margin-left: auto; font-size: 0.9rem; color: var(--gold); white-space: nowrap; }

  /* ===== SUCCESS PAGE ===== */
  .success-page {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 80px 40px;
    padding-top: 140px;
  }
  .success-icon {
    width: 80px; height: 80px;
    background: var(--gold);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    margin: 0 auto 32px;
    animation: popIn 0.5s ease;
  }
  @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
  .success-page h1 { font-family: 'Cormorant Garamond', serif; font-size: 3.5rem; font-weight: 300; margin-bottom: 16px; }
  .success-page p { color: var(--muted); max-width: 480px; line-height: 1.8; margin-bottom: 8px; }
  .order-number { font-size: 0.8rem; color: var(--gold); letter-spacing: 0.15em; margin-bottom: 40px; }
  .success-actions { display: flex; gap: 16px; margin-top: 12px; }

  /* ===== ABOUT / OUTBOUND ===== */
  .outbound-banner {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 40px 48px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 24px;
    margin: 0 60px 60px;
  }
  .outbound-text h3 { font-family: 'Cormorant Garamond', serif; font-size: 1.8rem; margin-bottom: 6px; }
  .outbound-text p { color: var(--muted); font-size: 0.9rem; }
  .outbound-link {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    color: #000;
    background: var(--gold);
    text-decoration: none;
    padding: 14px 28px;
    font-size: 0.8rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    font-weight: 600;
    white-space: nowrap;
    transition: background 0.2s;
    flex-shrink: 0;
  }
  .outbound-link:hover { background: var(--gold2); }

  /* ===== TOAST ===== */
  .toast {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: var(--surface);
    border: 1px solid var(--gold);
    padding: 16px 24px;
    display: flex;
    align-items: center;
    gap: 12px;
    z-index: 9999;
    transform: translateY(100px);
    opacity: 0;
    transition: all 0.3s ease;
    max-width: 340px;
  }
  .toast.show { transform: translateY(0); opacity: 1; }
  .toast-icon { font-size: 1.2rem; }
  .toast-msg { font-size: 0.88rem; }
  .toast-msg strong { display: block; font-weight: 500; margin-bottom: 2px; }
  .toast-msg span { color: var(--muted); font-size: 0.8rem; }

  /* ===== STARS ===== */
  .stars { color: var(--gold); letter-spacing: -2px; font-size: 0.8rem; }

  /* ===== MODAL ===== */
  .modal-overlay {
    position: fixed; inset: 0;
    background: rgba(0,0,0,0.85);
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0; pointer-events: none;
    transition: opacity 0.3s;
  }
  .modal-overlay.open { opacity: 1; pointer-events: all; }
  .modal {
    background: var(--surface);
    border: 1px solid var(--border);
    max-width: 700px;
    width: 90%;
    padding: 48px;
    position: relative;
    transform: translateY(20px);
    transition: transform 0.3s;
    max-height: 85vh;
    overflow-y: auto;
  }
  .modal-overlay.open .modal { transform: translateY(0); }
  .modal-close {
    position: absolute;
    top: 16px; right: 20px;
    background: none;
    border: none;
    color: var(--muted);
    font-size: 1.5rem;
    cursor: pointer;
    transition: color 0.2s;
  }
  .modal-close:hover { color: var(--text); }
  .modal-body { display: grid; grid-template-columns: 1fr 1fr; gap: 36px; }
  .modal-img {
    height: 280px;
    background: var(--surface2);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 6rem;
    border: 1px solid var(--border);
  }
  .modal-info {}
  .modal-cat { font-size: 0.72rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--gold); margin-bottom: 8px; }
  .modal-name { font-family: 'Cormorant Garamond', serif; font-size: 2rem; font-weight: 600; margin-bottom: 12px; }
  .modal-price { font-size: 1.5rem; color: var(--gold); margin-bottom: 16px; }
  .modal-desc { color: var(--muted); font-size: 0.88rem; line-height: 1.8; margin-bottom: 24px; }
  .size-label { font-size: 0.72rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--muted); margin-bottom: 10px; }
  .size-options { display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
  .size-btn {
    border: 1px solid var(--border);
    background: transparent;
    color: var(--text);
    padding: 6px 14px;
    font-size: 0.82rem;
    cursor: pointer;
    transition: all 0.2s;
  }
  .size-btn:hover, .size-btn.active { border-color: var(--gold); color: var(--gold); background: rgba(201,168,76,0.08); }

  /* Color options */
  .color-options { display: flex; gap: 8px; margin-bottom: 20px; }
  .color-swatch {
    width: 24px; height: 24px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }
  .color-swatch.active { border-color: var(--gold); }

  .modal-add-btn {
    width: 100%;
    background: var(--gold);
    color: #000;
    border: none;
    padding: 14px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.82rem;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.2s;
  }
  .modal-add-btn:hover { background: var(--gold2); }

  /* ===== SIGN IN PAGE ===== */
  .auth-page {
    padding-top: 70px;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 120px 40px 60px;
  }
  .auth-card {
    background: var(--surface);
    border: 1px solid var(--border);
    padding: 56px;
    width: 100%;
    max-width: 480px;
  }
  .auth-logo { text-align: center; margin-bottom: 36px; }
  .auth-title { font-family: 'Cormorant Garamond', serif; font-size: 2.2rem; font-weight: 300; text-align: center; margin-bottom: 8px; }
  .auth-sub { color: var(--muted); text-align: center; font-size: 0.88rem; margin-bottom: 36px; }
  .auth-form { display: flex; flex-direction: column; gap: 16px; }
  .auth-divider { display: flex; align-items: center; gap: 16px; margin: 8px 0; color: var(--muted); font-size: 0.78rem; }
  .auth-divider::before, .auth-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
  .auth-switch { text-align: center; font-size: 0.85rem; color: var(--muted); margin-top: 20px; }
  .auth-switch a { color: var(--gold); cursor: pointer; text-decoration: none; }
  .social-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    color: var(--text);
    padding: 12px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.85rem;
    cursor: pointer;
    transition: border-color 0.2s;
  }
  .social-btn:hover { border-color: var(--gold); }

  /* ===== RESPONSIVE BASICS ===== */
  @media (max-width: 900px) {
    header { padding: 0 20px; }
    nav { display: none; }
    .hero { grid-template-columns: 1fr; }
    .hero-right { display: none; }
    section, .cart-layout, .checkout-layout, .shop-layout { padding-left: 20px; padding-right: 20px; }
    .cart-layout, .checkout-layout { grid-template-columns: 1fr; }
    .shop-layout { grid-template-columns: 1fr; }
    .features-strip { grid-template-columns: 1fr 1fr; }
    .footer-grid { grid-template-columns: 1fr 1fr; }
    .modal-body { grid-template-columns: 1fr; }
    .outbound-banner { flex-direction: column; margin: 0 20px 40px; }
  }
</style>
</head>
<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NFLMNZZ2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<!-- ============================================================ -->
<!--  DATA LAYER INSPECTOR PANEL (Dev Tool ‚Äî toggle with Alt+D)   -->
<!-- ============================================================ -->
<div id="dl-panel" style="
  position:fixed;bottom:0;right:0;width:480px;height:360px;
  background:#0d1117;border:1px solid #30363d;border-bottom:none;border-right:none;
  z-index:99999;display:none;flex-direction:column;font-family:'DM Sans',monospace;
  box-shadow:-4px -4px 24px rgba(0,0,0,0.6);
">
  <div style="
    display:flex;align-items:center;justify-content:space-between;
    padding:10px 16px;background:#161b22;border-bottom:1px solid #30363d;flex-shrink:0;
  ">
    <div style="display:flex;align-items:center;gap:10px;">
      <span style="width:8px;height:8px;border-radius:50%;background:#52c472;display:inline-block;animation:dlBlink 1.5s infinite;"></span>
      <span style="color:#e6edf3;font-size:0.8rem;font-weight:600;letter-spacing:0.08em;">DATA LAYER INSPECTOR</span>
      <span id="dl-event-count" style="background:#21262d;color:#8b949e;font-size:0.7rem;padding:2px 8px;border-radius:10px;">0 events</span>
    </div>
    <div style="display:flex;gap:8px;align-items:center;">
      <button onclick="clearDLLog()" style="background:#21262d;border:1px solid #30363d;color:#8b949e;padding:3px 10px;font-size:0.72rem;cursor:pointer;border-radius:3px;">Clear</button>
      <button onclick="toggleDLPanel()" style="background:none;border:none;color:#8b949e;font-size:1.1rem;cursor:pointer;line-height:1;">‚úï</button>
    </div>
  </div>
  <!-- Tab bar -->
  <div style="display:flex;border-bottom:1px solid #30363d;flex-shrink:0;background:#161b22;">
    <button class="dl-tab active" onclick="switchDLTab('events',this)" style="padding:7px 16px;background:none;border:none;border-bottom:2px solid #c9a84c;color:#c9a84c;font-size:0.75rem;cursor:pointer;letter-spacing:0.06em;">EVENTS</button>
    <button class="dl-tab" onclick="switchDLTab('state',this)" style="padding:7px 16px;background:none;border:none;border-bottom:2px solid transparent;color:#8b949e;font-size:0.75rem;cursor:pointer;letter-spacing:0.06em;">CURRENT STATE</button>
    <button class="dl-tab" onclick="switchDLTab('cart',this)" style="padding:7px 16px;background:none;border:none;border-bottom:2px solid transparent;color:#8b949e;font-size:0.75rem;cursor:pointer;letter-spacing:0.06em;">CART DATA</button>
  </div>
  <!-- Events log -->
  <div id="dl-tab-events" style="flex:1;overflow-y:auto;padding:8px 0;" class="dl-tab-content"></div>
  <!-- Current state -->
  <div id="dl-tab-state" style="flex:1;overflow-y:auto;padding:12px 16px;display:none;" class="dl-tab-content">
    <pre id="dl-state-json" style="color:#79c0ff;font-size:0.72rem;line-height:1.7;white-space:pre-wrap;"></pre>
  </div>
  <!-- Cart data -->
  <div id="dl-tab-cart" style="flex:1;overflow-y:auto;padding:12px 16px;display:none;" class="dl-tab-content">
    <pre id="dl-cart-json" style="color:#56d364;font-size:0.72rem;line-height:1.7;white-space:pre-wrap;"></pre>
  </div>
</div>

<!-- Toggle hint badge -->
<div id="dl-hint" onclick="toggleDLPanel()" style="
  position:fixed;bottom:16px;right:16px;z-index:99998;
  background:#0d1117;border:1px solid #c9a84c;color:#c9a84c;
  padding:7px 14px;font-size:0.7rem;letter-spacing:0.1em;cursor:pointer;
  display:flex;align-items:center;gap:7px;
  box-shadow:0 4px 16px rgba(0,0,0,0.5);
">
  <span style="width:7px;height:7px;border-radius:50%;background:#52c472;display:inline-block;animation:dlBlink 1.5s infinite;"></span>
  DATA LAYER <span id="dl-badge-count" style="background:#c9a84c;color:#000;border-radius:10px;padding:1px 7px;font-weight:700;">0</span>
</div>

<style>
  @keyframes dlBlink { 0%,100%{opacity:1} 50%{opacity:0.3} }
  #dl-panel::-webkit-scrollbar { width:4px; }
  #dl-panel *::-webkit-scrollbar { width:4px; }
  #dl-panel *::-webkit-scrollbar-thumb { background:#30363d; }
  .dl-entry { padding:7px 16px; border-bottom:1px solid #21262d; cursor:pointer; transition:background 0.15s; }
  .dl-entry:hover { background:#161b22; }
  .dl-entry-header { display:flex; align-items:center; justify-content:space-between; }
  .dl-event-name { font-size:0.76rem; font-weight:600; }
  .dl-event-time { font-size:0.67rem; color:#8b949e; }
  .dl-event-preview { font-size:0.7rem; color:#8b949e; margin-top:3px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:380px; }
  .dl-payload { display:none; margin-top:8px; padding:8px; background:#161b22; border-radius:4px; }
  .dl-payload pre { font-size:0.68rem; color:#79c0ff; line-height:1.6; white-space:pre-wrap; }
  .dl-entry.expanded .dl-payload { display:block; }
  .dl-tag-ecom { color:#56d364; }
  .dl-tag-nav { color:#79c0ff; }
  .dl-tag-user { color:#d2a8ff; }
  .dl-tag-ui { color:#ffa657; }
  .dl-tab.active { color:#c9a84c !important; border-bottom-color:#c9a84c !important; }
</style>

<!-- ============================================================ -->
<!--  HEADER  -->
<!-- ============================================================ -->
<header>
  <a class="logo" onclick="showPage('home')">LUXE<span>MARKET</span></a>
  <nav>
    <a onclick="showPage('home')" id="nav-home" class="active">Home</a>
    <a onclick="showPage('shop')" id="nav-shop">Shop</a>
    <a onclick="showPage('about')" id="nav-about">About</a>
    <a onclick="showPage('signin')" id="nav-signin">Sign In</a>
  </nav>
  <div class="header-right">
    <button class="cart-btn" onclick="showPage('cart')">
      üõç Cart
      <span class="cart-count" id="cartCount">0</span>
    </button>
  </div>
</header>

<!-- ============================================================ -->
<!--  PRODUCT MODAL  -->
<!-- ============================================================ -->
<div class="modal-overlay" id="productModal" onclick="closeModal(event)">
  <div class="modal">
    <button class="modal-close" onclick="closeProductModal()">‚úï</button>
    <div class="modal-body">
      <div class="modal-img" id="modalImg">üì¶</div>
      <div class="modal-info">
        <div class="modal-cat" id="modalCat">Category</div>
        <div class="modal-name" id="modalName">Product</div>
        <div class="modal-price" id="modalPrice">$0</div>
        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <p style="color:var(--muted);font-size:0.75rem;margin:4px 0 14px;">142 reviews</p>
        <p class="modal-desc" id="modalDesc">Description</p>
        <div class="size-label">SIZE</div>
        <div class="size-options">
          <button class="size-btn active" onclick="selectSize(this)">XS</button>
          <button class="size-btn" onclick="selectSize(this)">S</button>
          <button class="size-btn" onclick="selectSize(this)">M</button>
          <button class="size-btn" onclick="selectSize(this)">L</button>
          <button class="size-btn" onclick="selectSize(this)">XL</button>
        </div>
        <div class="size-label">COLOR</div>
        <div class="color-options">
          <div class="color-swatch active" style="background:#c9a84c;" onclick="selectColor(this)"></div>
          <div class="color-swatch" style="background:#1a1a2e;" onclick="selectColor(this)"></div>
          <div class="color-swatch" style="background:#8b3a3a;" onclick="selectColor(this)"></div>
          <div class="color-swatch" style="background:#2d4a3e;" onclick="selectColor(this)"></div>
        </div>
        <button class="modal-add-btn" id="modalAddBtn">Add to Cart</button>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ -->
<!--  TOAST  -->
<!-- ============================================================ -->
<div class="toast" id="toast">
  <span class="toast-icon">‚úÖ</span>
  <div class="toast-msg">
    <strong id="toastTitle">Added to cart!</strong>
    <span id="toastSub">Item has been added to your bag.</span>
  </div>
</div>

<!-- ============================================================ -->
<!--  PAGE: HOME  -->
<!-- ============================================================ -->
<div class="page active" id="page-home">

  <!-- Hero -->
  <section class="hero" style="padding:0;">
    <div class="hero-left">
      <div class="hero-tag">New Collection 2025</div>
      <h1>Crafted for <em>Those Who Know</em></h1>
      <p>Discover a curated selection of premium goods designed to elevate the everyday. Quality without compromise, delivered to your door.</p>
      <div class="hero-btns">
        <button class="btn-primary" onclick="showPage('shop')">Shop Collection</button>
        <button class="btn-outline" onclick="showPage('about')">Our Story</button>
      </div>
    </div>
    <div class="hero-right">
      <div class="hero-visual">
        <div class="hero-img-placeholder">
          <div class="hero-badge">NEW IN</div>
          <div class="hero-product-icon">üíé</div>
          <p style="color:var(--muted);font-size:0.8rem;letter-spacing:0.1em;text-transform:uppercase;">Signature Edition</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Marquee -->
  <div class="marquee-wrap">
    <div class="marquee">
      <span>Free Shipping on Orders Over $150</span><span class="dot">‚ú¶</span>
      <span>New Arrivals Every Week</span><span class="dot">‚ú¶</span>
      <span>Premium Quality Guaranteed</span><span class="dot">‚ú¶</span>
      <span>Easy Returns Within 30 Days</span><span class="dot">‚ú¶</span>
      <span>Exclusive Members Discounts</span><span class="dot">‚ú¶</span>
      <span>Free Shipping on Orders Over $150</span><span class="dot">‚ú¶</span>
      <span>New Arrivals Every Week</span><span class="dot">‚ú¶</span>
      <span>Premium Quality Guaranteed</span><span class="dot">‚ú¶</span>
      <span>Easy Returns Within 30 Days</span><span class="dot">‚ú¶</span>
      <span>Exclusive Members Discounts</span><span class="dot">‚ú¶</span>
    </div>
  </div>

  <!-- Featured Products -->
  <section>
    <div class="section-header">
      <h2 class="section-title">Featured <em>Pieces</em></h2>
      <a class="section-link" onclick="showPage('shop')">View All ‚Üí</a>
    </div>
    <div class="products-grid" id="featured-grid"></div>
  </section>

  <!-- Features -->
  <div class="features-strip" style="margin:0 60px 60px;">
    <div class="feature-item">
      <div class="feature-icon">üöÄ</div>
      <div>
        <div class="feature-title">Express Delivery</div>
        <div class="feature-desc">2-day shipping on all orders. Free over $150.</div>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-icon">‚ôªÔ∏è</div>
      <div>
        <div class="feature-title">Easy Returns</div>
        <div class="feature-desc">Hassle-free 30-day return policy.</div>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-icon">üîí</div>
      <div>
        <div class="feature-title">Secure Payment</div>
        <div class="feature-desc">256-bit SSL encryption on all transactions.</div>
      </div>
    </div>
    <div class="feature-item">
      <div class="feature-icon">üéÅ</div>
      <div>
        <div class="feature-title">Gift Wrapping</div>
        <div class="feature-desc">Complimentary luxury gift wrapping available.</div>
      </div>
    </div>
  </div>

  <!-- Newsletter -->
  <div class="newsletter">
    <h2>Stay in the <em>Loop</em></h2>
    <p>Sign up for exclusive offers, new arrivals, and insider-only deals.</p>
    <form class="newsletter-form" onsubmit="subscribeNewsletter(event)">
      <input type="email" class="nl-input" placeholder="your@email.com" id="nlEmail" required>
      <button class="nl-btn" type="submit">Subscribe</button>
    </form>
    <p class="nl-success" id="nlSuccess">üéâ You're in! Check your inbox for a welcome gift.</p>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-grid">
      <div class="footer-brand">
        <span class="logo">LUXE<span style="color:var(--text);font-weight:300;">MARKET</span></span>
        <p>Curated luxury goods for the discerning shopper. Premium quality, exceptional service, delivered to your door.</p>
      </div>
      <div class="footer-col">
        <h4>Shop</h4>
        <a onclick="showPage('shop')">All Products</a>
        <a onclick="showPage('shop')">New Arrivals</a>
        <a onclick="showPage('shop')">Best Sellers</a>
        <a onclick="showPage('shop')">Sale</a>
      </div>
      <div class="footer-col">
        <h4>Company</h4>
        <a onclick="showPage('about')">About Us</a>
        <a href="https://www.anthropic.com" target="_blank" rel="noopener">Our Partner ‚Üí</a>
        <a onclick="showPage('signin')">Sign In</a>
        <a onclick="showPage('about')">Careers</a>
      </div>
      <div class="footer-col">
        <h4>Support</h4>
        <a href="#">FAQ</a>
        <a href="#">Shipping</a>
        <a href="#">Returns</a>
        <a href="#">Contact</a>
      </div>
    </div>
    <div class="footer-bottom">
      <span>¬© 2025 LuxeMarket. All rights reserved.</span>
      <span>Built with ‚ô• &nbsp;|&nbsp; <a href="https://www.anthropic.com" target="_blank" rel="noopener">Powered by Anthropic ‚Üí</a></span>
    </div>
  </footer>
</div>
<!-- ============================================================ -->
<!--  PAGE: SHOP  -->
<!-- ============================================================ -->
<div class="page" id="page-shop">
  <div class="page-hero">
    <h1>The <em style="font-style:italic;color:var(--gold);">Collection</em></h1>
    <p>Handpicked premium goods for the modern connoisseur.</p>
  </div>

  <div class="shop-layout">
    <!-- Filters -->
    <aside class="shop-filters">
      <div class="filter-group">
        <div class="filter-title">Category</div>
        <div class="filter-item"><input type="checkbox" id="f-all" checked onchange="filterProducts()"><label for="f-all">All Items</label></div>
        <div class="filter-item"><input type="checkbox" id="f-accessories" onchange="filterProducts()"><label for="f-accessories">Accessories</label></div>
        <div class="filter-item"><input type="checkbox" id="f-apparel" onchange="filterProducts()"><label for="f-apparel">Apparel</label></div>
        <div class="filter-item"><input type="checkbox" id="f-lifestyle" onchange="filterProducts()"><label for="f-lifestyle">Lifestyle</label></div>
        <div class="filter-item"><input type="checkbox" id="f-tech" onchange="filterProducts()"><label for="f-tech">Tech</label></div>
      </div>
      <div class="filter-group">
        <div class="filter-title">Price Range</div>
        <div class="price-range">
          <input type="range" class="range-input" min="0" max="500" value="500" id="priceRange" oninput="updatePriceLabel(this.value)">
          <div class="range-labels"><span>$0</span><span id="priceLabel">$500</span></div>
        </div>
      </div>
      <div class="filter-group">
        <div class="filter-title">Rating</div>
        <div class="filter-item"><input type="radio" name="rating" id="r-all" checked><label for="r-all">All Ratings</label></div>
        <div class="filter-item"><input type="radio" name="rating" id="r-4"><label for="r-4">4‚òÖ & Above</label></div>
        <div class="filter-item"><input type="radio" name="rating" id="r-3"><label for="r-3">3‚òÖ & Above</label></div>
      </div>
      <button class="btn-primary" style="width:100%;margin-top:8px;" onclick="filterProducts()">Apply Filters</button>
    </aside>

    <!-- Products -->
    <div>
      <div class="sort-bar">
        <span class="results-count" id="resultsCount">12 products</span>
        <select class="sort-select" onchange="sortProducts(this.value)">
          <option value="featured">Featured</option>
          <option value="price-low">Price: Low to High</option>
          <option value="price-high">Price: High to Low</option>
          <option value="newest">Newest</option>
        </select>
      </div>
      <div class="products-grid" id="shop-grid"></div>
    </div>
  </div>

  <!-- Outbound Banner -->
  <div class="outbound-banner">
    <div class="outbound-text">
      <h3>Crafted with AI Intelligence</h3>
      <p>Our product curation is powered by Anthropic's Claude ‚Äî the world's most thoughtful AI assistant.</p>
    </div>
    <a href="https://www.anthropic.com" target="_blank" rel="noopener" class="outbound-link">
      Visit Anthropic ‚Üó
    </a>
  </div>

  <footer>
    <div class="footer-bottom" style="border:none;padding:0;">
      <span>¬© 2025 LuxeMarket. All rights reserved.</span>
      <button class="btn-outline" onclick="showPage('home')" style="padding:8px 20px;font-size:0.75rem;">‚Üê Back to Home</button>
    </div>
  </footer>
</div>

<!-- ============================================================ -->
<!--  PAGE: CART  -->
<!-- ============================================================ -->
<div class="page" id="page-cart">
  <div class="page-hero">
    <h1>Your <em style="font-style:italic;color:var(--gold);">Bag</em></h1>
    <p id="cart-subtitle">0 items in your cart</p>
  </div>

  <div class="cart-layout" id="cart-layout-inner">
    <div id="cart-items-container"></div>
    <div class="cart-summary" id="cart-summary-box">
      <div class="summary-title">Order Summary</div>
      <div class="summary-row"><span class="label">Subtotal</span><span id="summarySubtotal">$0.00</span></div>
      <div class="summary-row"><span class="label">Shipping</span><span id="summaryShipping">Free</span></div>
      <div class="summary-row"><span class="label">Tax (8%)</span><span id="summaryTax">$0.00</span></div>

      <div class="promo-section">
        <div class="promo-label">Promo Code</div>
        <div class="promo-row">
          <input type="text" class="promo-input" id="promoInput" placeholder="LUXE25">
          <button class="promo-btn" onclick="applyPromo()">Apply</button>
        </div>
        <p class="promo-msg" id="promoMsg"></p>
      </div>

      <div class="summary-total">
        <span>Total</span>
        <span class="gold" id="summaryTotal">$0.00</span>
      </div>
      <button class="checkout-btn" onclick="showPage('checkout')">Proceed to Checkout ‚Üí</button>
      <p class="secure-note">üîí Secure checkout ‚Äî SSL encrypted</p>
    </div>
  </div>
</div>

<!-- ============================================================ -->
<!--  PAGE: CHECKOUT  -->
<!-- ============================================================ -->
<div class="page" id="page-checkout">
  <div class="page-hero">
    <h1>Check<em style="font-style:italic;color:var(--gold);">out</em></h1>
    <p>Complete your order below.</p>
  </div>

  <div class="checkout-layout">
    <form class="checkout-form" onsubmit="placeOrder(event)">

      <!-- Contact -->
      <div class="form-section">
        <div class="form-section-title"><span class="form-section-num">1</span>Contact Information</div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">First Name</label>
            <input type="text" class="form-input" placeholder="Jane" required>
          </div>
          <div class="form-group">
            <label class="form-label">Last Name</label>
            <input type="text" class="form-input" placeholder="Doe" required>
          </div>
        </div>
        <div class="form-row full">
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input type="email" class="form-input" placeholder="jane@example.com" required>
          </div>
        </div>
        <div class="form-row full">
          <div class="form-group">
            <label class="form-label">Phone Number</label>
            <input type="tel" class="form-input" placeholder="+1 (555) 000-0000">
          </div>
        </div>
      </div>

      <!-- Shipping -->
      <div class="form-section">
        <div class="form-section-title"><span class="form-section-num">2</span>Shipping Address</div>
        <div class="form-row full">
          <div class="form-group">
            <label class="form-label">Address Line 1</label>
            <input type="text" class="form-input" placeholder="123 Luxury Lane" required>
          </div>
        </div>
        <div class="form-row full">
          <div class="form-group">
            <label class="form-label">Address Line 2</label>
            <input type="text" class="form-input" placeholder="Apt, Suite, etc. (optional)">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">City</label>
            <input type="text" class="form-input" placeholder="New York" required>
          </div>
          <div class="form-group">
            <label class="form-label">State</label>
            <select class="form-select form-input">
              <option value="">Select State</option>
              <option>New York</option>
              <option>California</option>
              <option>Texas</option>
              <option>Florida</option>
              <option>Illinois</option>
              <option>Other</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">ZIP Code</label>
            <input type="text" class="form-input" placeholder="10001" required>
          </div>
          <div class="form-group">
            <label class="form-label">Country</label>
            <select class="form-select form-input">
              <option>United States</option>
              <option>Canada</option>
              <option>United Kingdom</option>
              <option>Australia</option>
              <option>India</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Shipping Method -->
      <div class="form-section">
        <div class="form-section-title"><span class="form-section-num">3</span>Shipping Method</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <label style="display:flex;align-items:center;justify-content:space-between;padding:16px;border:1px solid var(--gold);background:rgba(201,168,76,0.06);cursor:pointer;">
            <div style="display:flex;align-items:center;gap:14px;">
              <input type="radio" name="shipping" value="free" checked style="accent-color:var(--gold);">
              <div>
                <div style="font-size:0.9rem;">Standard Shipping</div>
                <div style="font-size:0.75rem;color:var(--muted);">5‚Äì7 business days</div>
              </div>
            </div>
            <span style="color:var(--gold);">FREE</span>
          </label>
          <label style="display:flex;align-items:center;justify-content:space-between;padding:16px;border:1px solid var(--border);cursor:pointer;">
            <div style="display:flex;align-items:center;gap:14px;">
              <input type="radio" name="shipping" value="express" style="accent-color:var(--gold);">
              <div>
                <div style="font-size:0.9rem;">Express Shipping</div>
                <div style="font-size:0.75rem;color:var(--muted);">2‚Äì3 business days</div>
              </div>
            </div>
            <span>$12.99</span>
          </label>
          <label style="display:flex;align-items:center;justify-content:space-between;padding:16px;border:1px solid var(--border);cursor:pointer;">
            <div style="display:flex;align-items:center;gap:14px;">
              <input type="radio" name="shipping" value="overnight" style="accent-color:var(--gold);">
              <div>
                <div style="font-size:0.9rem;">Overnight Delivery</div>
                <div style="font-size:0.75rem;color:var(--muted);">Next business day</div>
              </div>
            </div>
            <span>$29.99</span>
          </label>
        </div>
      </div>

      <!-- Payment -->
      <div class="form-section">
        <div class="form-section-title"><span class="form-section-num">4</span>Payment</div>

        <div class="payment-methods">
          <div class="payment-method selected" onclick="selectPayment(this,'card')">
            <input type="radio" name="payment" value="card" checked>
            <label><span class="payment-icon">üí≥</span>Credit Card</label>
          </div>
          <div class="payment-method" onclick="selectPayment(this,'paypal')">
            <input type="radio" name="payment" value="paypal">
            <label><span class="payment-icon">üÖøÔ∏è</span>PayPal</label>
          </div>
          <div class="payment-method" onclick="selectPayment(this,'apple')">
            <input type="radio" name="payment" value="apple">
            <label><span class="payment-icon">üçé</span>Apple Pay</label>
          </div>
        </div>

        <!-- Card Form -->
        <div id="card-form">
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">Name on Card</label>
              <input type="text" class="form-input" placeholder="Jane Doe">
            </div>
          </div>
          <div class="form-row full">
            <div class="form-group">
              <label class="form-label">Card Number</label>
              <input type="text" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19" oninput="formatCard(this)">
            </div>
          </div>
          <div class="form-row three">
            <div class="form-group">
              <label class="form-label">Expiry Month</label>
              <select class="form-select form-input">
                <option value="">MM</option>
                <option>01</option><option>02</option><option>03</option><option>04</option>
                <option>05</option><option>06</option><option>07</option><option>08</option>
                <option>09</option><option>10</option><option>11</option><option>12</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Expiry Year</label>
              <select class="form-select form-input">
                <option value="">YY</option>
                <option>2025</option><option>2026</option><option>2027</option>
                <option>2028</option><option>2029</option><option>2030</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">CVV</label>
              <input type="text" class="form-input" placeholder="123" maxlength="4">
            </div>
          </div>
        </div>

        <!-- PayPal section -->
        <div id="paypal-form" style="display:none;">
          <div class="paypal-section">
            <p style="color:var(--muted);margin-bottom:20px;font-size:0.88rem;">You'll be redirected to PayPal to complete your payment securely.</p>
            <button type="button" class="paypal-btn" onclick="showToastMsg('PayPal','Redirecting to PayPal...')">
              Pay with <span style="font-style:italic;">Pay</span><span style="font-weight:300;">Pal</span>
            </button>
          </div>
        </div>

        <!-- Apple Pay -->
        <div id="apple-form" style="display:none;">
          <div class="paypal-section" style="background:#000;border-color:#333;">
            <p style="color:#888;margin-bottom:20px;font-size:0.88rem;">Use Face ID or Touch ID to pay instantly.</p>
            <button type="button" style="background:#fff;color:#000;border:none;padding:14px 40px;font-size:1.1rem;font-weight:700;cursor:pointer;border-radius:8px;" onclick="showToastMsg('Apple Pay','Authenticating with Apple Pay...')">
              üçé Pay
            </button>
          </div>
        </div>
      </div>

      <button type="submit" class="btn-primary" style="width:100%;padding:18px;font-size:0.9rem;">
        Place Order ‚Üí 
      </button>
      <p style="text-align:center;color:var(--muted);font-size:0.75rem;margin-top:12px;">
        üîí Encrypted &amp; Secure &nbsp;|&nbsp; 30-Day Returns &nbsp;|&nbsp; 24/7 Support
      </p>
    </form>

    <!-- Order Summary -->
    <div class="order-summary">
      <div class="summary-title">Your Order</div>
      <div id="checkout-items"></div>
      <div class="summary-row" style="margin-top:8px;"><span class="label">Subtotal</span><span id="co-subtotal">$0.00</span></div>
      <div class="summary-row"><span class="label">Shipping</span><span>Free</span></div>
      <div class="summary-row"><span class="label">Tax</span><span id="co-tax">$0.00</span></div>
      <div class="summary-total">
        <span>Total</span>
        <span class="gold" id="co-total">$0.00</span>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ -->
<!--  PAGE: SUCCESS  -->
<!-- ============================================================ -->
<div class="page" id="page-success">
  <div class="success-page">
    <div class="success-icon">‚úì</div>
    <h1>Order Placed!</h1>
    <p>Thank you for shopping with LuxeMarket. Your order has been confirmed and is being prepared with care.</p>
    <p class="order-number" id="orderNumber">Order #LM-000000</p>
    <p style="color:var(--muted);font-size:0.85rem;">A confirmation email has been sent to your inbox.</p>
    <div class="success-actions">
      <button class="btn-primary" onclick="showPage('shop')">Continue Shopping</button>
      <button class="btn-outline" onclick="showPage('home')">Back to Home</button>
    </div>
  </div>
</div>

<!-- ============================================================ -->
<!--  PAGE: ABOUT  -->
<!-- ============================================================ -->
<div class="page" id="page-about">
  <div class="page-hero">
    <h1>Our <em style="font-style:italic;color:var(--gold);">Story</em></h1>
    <p>Luxury redefined for the modern world.</p>
  </div>

  <section style="max-width:800px;">
    <p style="font-size:1.15rem;line-height:1.9;color:var(--muted);margin-bottom:28px;">
      Founded in 2020, LuxeMarket began with a simple idea: premium goods shouldn't be out of reach. We partner directly with artisans and top-tier manufacturers to bring you curated collections that blend quality, design, and value.
    </p>
    <p style="font-size:1.15rem;line-height:1.9;color:var(--muted);margin-bottom:48px;">
      Every product in our store is hand-selected by our team of style experts. We believe in sustainable fashion, ethical sourcing, and the idea that what you wear and use every day should bring you joy.
    </p>
    <h2 style="font-family:'Cormorant Garamond',serif;font-size:2.5rem;font-weight:300;margin-bottom:24px;">Our <em style="font-style:italic;color:var(--gold);">Values</em></h2>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:60px;">
      <div style="padding:28px;border:1px solid var(--border);background:var(--surface);">
        <div style="font-size:2rem;margin-bottom:12px;">üåø</div>
        <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:8px;">Sustainability</h3>
        <p style="color:var(--muted);font-size:0.88rem;line-height:1.7;">We offset 100% of our carbon footprint and use eco-conscious packaging on every shipment.</p>
      </div>
      <div style="padding:28px;border:1px solid var(--border);background:var(--surface);">
        <div style="font-size:2rem;margin-bottom:12px;">ü§ù</div>
        <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:8px;">Fair Trade</h3>
        <p style="color:var(--muted);font-size:0.88rem;line-height:1.7;">Every partner in our supply chain is vetted for fair wages and safe working conditions.</p>
      </div>
      <div style="padding:28px;border:1px solid var(--border);background:var(--surface);">
        <div style="font-size:2rem;margin-bottom:12px;">‚≠ê</div>
        <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:8px;">Quality First</h3>
        <p style="color:var(--muted);font-size:0.88rem;line-height:1.7;">Every item passes rigorous quality checks before it reaches your door. No compromises.</p>
      </div>
      <div style="padding:28px;border:1px solid var(--border);background:var(--surface);">
        <div style="font-size:2rem;margin-bottom:12px;">‚ù§Ô∏è</div>
        <h3 style="font-family:'Cormorant Garamond',serif;font-size:1.3rem;margin-bottom:8px;">Community</h3>
        <p style="color:var(--muted);font-size:0.88rem;line-height:1.7;">5% of all profits go to literacy programs and youth entrepreneurship worldwide.</p>
      </div>
    </div>
  </section>

  <!-- Outbound Link -->
  <div class="outbound-banner">
    <div class="outbound-text">
      <h3>Powered by Anthropic</h3>
      <p>LuxeMarket's intelligent product recommendations are built with Claude AI ‚Äî experience the future of shopping.</p>
    </div>
    <a href="https://www.anthropic.com" target="_blank" rel="noopener noreferrer" class="outbound-link">
      Learn More at Anthropic ‚Üó
    </a>
  </div>

  <footer>
    <div class="footer-bottom" style="border:none;padding:0;">
      <span>¬© 2025 LuxeMarket. All rights reserved.</span>
      <button class="btn-outline" onclick="showPage('home')" style="padding:8px 20px;font-size:0.75rem;">‚Üê Back to Home</button>
    </div>
  </footer>
</div>

<!-- ============================================================ -->
<!--  PAGE: SIGN IN  -->
<!-- ============================================================ -->
<div class="page" id="page-signin">
  <div class="auth-page">
    <div class="auth-card" id="auth-card">
      <div class="auth-logo">
        <span class="logo" style="font-size:1.6rem;">LUXE<span style="color:var(--text);font-weight:300;">MARKET</span></span>
      </div>
      <!-- Sign In Form -->
      <div id="signin-form-wrap">
        <div class="auth-title">Welcome Back</div>
        <div class="auth-sub">Sign in to your account to continue shopping.</div>
        <form class="auth-form" onsubmit="handleSignIn(event)">
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" placeholder="jane@example.com" required>
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center;font-size:0.82rem;">
            <label style="display:flex;align-items:center;gap:8px;cursor:pointer;color:var(--muted);">
              <input type="checkbox" style="accent-color:var(--gold);"> Remember me
            </label>
            <a href="#" style="color:var(--gold);">Forgot password?</a>
          </div>
          <button type="submit" class="btn-primary" style="width:100%;padding:14px;margin-top:8px;">Sign In</button>
        </form>
        <div class="auth-divider">or continue with</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <button class="social-btn" onclick="showToastMsg('Google','Redirecting to Google...')">üåê Continue with Google</button>
          <button class="social-btn" onclick="showToastMsg('Apple','Authenticating with Apple...')">üçé Continue with Apple</button>
        </div>
        <p class="auth-switch">Don't have an account? <a onclick="toggleAuthForm()">Create one ‚Üí</a></p>
      </div>

      <!-- Register Form -->
      <div id="register-form-wrap" style="display:none;">
        <div class="auth-title">Create Account</div>
        <div class="auth-sub">Join LuxeMarket for exclusive access and offers.</div>
        <form class="auth-form" onsubmit="handleRegister(event)">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">First Name</label>
              <input type="text" class="form-input" placeholder="Jane" required>
            </div>
            <div class="form-group">
              <label class="form-label">Last Name</label>
              <input type="text" class="form-input" placeholder="Doe" required>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Email</label>
            <input type="email" class="form-input" placeholder="jane@example.com" required>
          </div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <input type="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="8" required>
          </div>
          <div class="form-group">
            <label class="form-label">Confirm Password</label>
            <input type="password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
          </div>
          <label style="display:flex;align-items:flex-start;gap:10px;cursor:pointer;color:var(--muted);font-size:0.82rem;">
            <input type="checkbox" style="accent-color:var(--gold);margin-top:2px;" required> 
            I agree to the <a href="#" style="color:var(--gold);margin-left:4px;">Terms of Service</a> and <a href="#" style="color:var(--gold);">Privacy Policy</a>
          </label>
          <button type="submit" class="btn-primary" style="width:100%;padding:14px;margin-top:8px;">Create Account</button>
        </form>
        <p class="auth-switch">Already have an account? <a onclick="toggleAuthForm()">Sign in ‚Üí</a></p>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================ -->
<!--  JAVASCRIPT ‚Äî with full GTM / GA4 Data Layer integration     -->
<!-- ============================================================ -->
<script>
'use strict';

/* ================================================================
   0. DATA LAYER CORE
   A thin wrapper around window.dataLayer that:
   - Ensures the array always exists
   - Timestamps every push
   - Logs to the in-page Inspector panel
   - Exposes dlPush() for all events below
================================================================ */
window.dataLayer = window.dataLayer || [];

const DL = {
  _eventCount: 0,

  push(payload) {
    // Attach timestamp
    payload.timestamp = new Date().toISOString();
    payload.session_id = DL._sessionId;
    window.dataLayer.push(payload);
    DL._eventCount++;
    DL._logToInspector(payload);
    DL._updateBadge();
    console.groupCollapsed(`%c[DataLayer] ${payload.event}`, 'color:#c9a84c;font-weight:bold;', payload.timestamp);
    console.log(JSON.parse(JSON.stringify(payload)));
    console.groupEnd();
  },

  // Unique session id for this tab
  _sessionId: 'sess_' + Math.random().toString(36).substr(2, 9),

  // Color coding per event category
  _eventColor(event) {
    if (!event) return '#8b949e';
    if (event.startsWith('view_item') || event.startsWith('add_') || event.startsWith('remove_') || event.includes('purchase') || event.includes('checkout') || event.includes('cart') || event.includes('promo')) return '#56d364'; // ecom green
    if (event.startsWith('page_') || event.startsWith('navigate')) return '#79c0ff';  // nav blue
    if (event.startsWith('login') || event.startsWith('sign') || event.startsWith('user')) return '#d2a8ff'; // user purple
    return '#ffa657'; // ui amber
  },

  _logToInspector(payload) {
    const log = document.getElementById('dl-tab-events');
    if (!log) return;
    const color = DL._eventColor(payload.event);
    const entry = document.createElement('div');
    entry.className = 'dl-entry';

    // Build a short preview string
    let preview = '';
    if (payload.ecommerce) {
      const items = payload.ecommerce.items || [];
      if (items.length) preview = items.map(i => `${i.item_name} √ó ${i.quantity||1}`).join(', ');
      if (payload.ecommerce.value) preview += (preview ? ' | ' : '') + `$${Number(payload.ecommerce.value).toFixed(2)}`;
    } else if (payload.page_name) preview = payload.page_name;
    else if (payload.method) preview = payload.method;
    else if (payload.coupon_code) preview = `code: ${payload.coupon_code}`;

    const now = new Date();
    const timeStr = `${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}.${String(now.getMilliseconds()).padStart(3,'0')}`;

    entry.innerHTML = `
      <div class="dl-entry-header">
        <span class="dl-event-name" style="color:${color};">${payload.event || '(push)'}</span>
        <span class="dl-event-time">${timeStr}</span>
      </div>
      ${preview ? `<div class="dl-event-preview">${preview}</div>` : ''}
      <div class="dl-payload"><pre>${JSON.stringify(payload, null, 2)}</pre></div>`;

    entry.onclick = () => entry.classList.toggle('expanded');

    // Prepend (newest on top)
    log.insertBefore(entry, log.firstChild);
    document.getElementById('dl-event-count').textContent = DL._eventCount + ' events';
  },

  _updateBadge() {
    const b = document.getElementById('dl-badge-count');
    if (b) { b.textContent = DL._eventCount; b.style.animation = 'none'; setTimeout(() => b.style.animation = '', 10); }
  },

  // Helper: build GA4-style items array from cart items
  cartToItems(cartArr) {
    return cartArr.map((item, idx) => ({
      item_id: `SKU_${String(item.id).padStart(4,'0')}`,
      item_name: item.name,
      item_category: item.cat,
      item_variant: item.selectedSize || 'Standard',
      item_brand: 'LuxeMarket',
      price: item.price,
      quantity: item.qty,
      index: idx,
      discount: item.originalPrice ? (item.originalPrice - item.price) : 0
    }));
  },

  // Helper: single product ‚Üí item object
  productToItem(p, qty = 1, idx = 0) {
    return {
      item_id: `SKU_${String(p.id).padStart(4,'0')}`,
      item_name: p.name,
      item_category: p.cat,
      item_variant: 'Standard',
      item_brand: 'LuxeMarket',
      price: p.price,
      quantity: qty,
      index: idx,
      discount: p.originalPrice ? (p.originalPrice - p.price) : 0,
      item_badge: p.badge || null
    };
  }
};

/* ================================================================
   1. PRODUCT CATALOG DATA
================================================================ */
const PRODUCTS = [
  { id:1,  name:'Obsidian Watch',         cat:'Accessories', price:299, originalPrice:399, emoji:'‚åö', badge:'SALE',       desc:'Hand-assembled precision timepiece. Swiss movement, sapphire crystal glass, and a rich obsidian case that commands attention in any room.',            colors:['#1a1a1a','#c9a84c','#8b3a3a'] },
  { id:2,  name:'Silk Evening Blouse',     cat:'Apparel',     price:189, originalPrice:null, emoji:'üëò', badge:null,        desc:'100% mulberry silk, cut on the bias for a fluid drape. Hand-finished French seams. Machine wash on silk cycle.',                                 colors:['#f0e6d3','#2d4a3e','#8b3a3a'] },
  { id:3,  name:'Leather Passport Wallet', cat:'Accessories', price:95,  originalPrice:null, emoji:'üëõ', badge:'NEW',       desc:'Full-grain vegetable-tanned leather. Patinas beautifully with age. Holds up to 6 cards plus your passport.',                                    colors:['#8b5e3c','#1a1a1a','#c9a84c'] },
  { id:4,  name:'Noise-Cancel Headphones', cat:'Tech',        price:349, originalPrice:449, emoji:'üéß', badge:'SALE',       desc:'40-hour battery, active noise cancellation, and 40mm custom drivers tuned for audiophile-grade warmth. Premium leather earcups.',               colors:['#1a1a1a','#f0e6d3'] },
  { id:5,  name:'Merino Wool Sweater',     cat:'Apparel',     price:225, originalPrice:null, emoji:'üß•', badge:null,        desc:'Extra-fine 18.5-micron Merino wool. Itch-free, temperature regulating, and naturally odor resistant. A lifelong wardrobe staple.',             colors:['#c9a84c','#2d4a3e','#1a1a2e'] },
  { id:6,  name:'Marble Chess Set',        cat:'Lifestyle',   price:480, originalPrice:null, emoji:'‚ôüÔ∏è', badge:'LIMITED',   desc:'Hand-carved Rajasthan marble with gilt inlay. Each piece takes over 3 hours to craft by master artisans in Agra, India.',                     colors:['#f0ebe3','#1a1a1a'] },
  { id:7,  name:'Monogram Backpack',       cat:'Accessories', price:275, originalPrice:null, emoji:'üéí', badge:null,        desc:'Japanese ballistic nylon with full-grain leather accents. 28L capacity, laptop sleeve, and hidden RFID pocket. Built to last decades.',       colors:['#1a1a1a','#8b5e3c'] },
  { id:8,  name:'Smart Wellness Band',     cat:'Tech',        price:199, originalPrice:249, emoji:'üìø', badge:'SALE',       desc:'Track sleep, HRV, blood oxygen, and stress. 7-day battery. Ultra-thin titanium frame. Works with iOS & Android.',                             colors:['#c9a84c','#1a1a1a','#2d4a3e'] },
  { id:9,  name:'Linen Dress Shirt',       cat:'Apparel',     price:145, originalPrice:null, emoji:'üëî', badge:null,        desc:'Stone-washed Belgian linen. Breathable, durable, and impossibly cool. A Sunday shirt for Tuesday boardrooms.',                                colors:['#f0e6d3','#2d4a3e','#8b3a3a'] },
  { id:10, name:'Artisan Candle Set',      cat:'Lifestyle',   price:85,  originalPrice:null, emoji:'üïØÔ∏è', badge:'BESTSELLER',desc:'Hand-poured soy wax with cotton wicks. Three signature scents: Oud & Amber, Bergamot & Vetiver, and White Tea & Sage. 60hr burn time.',     colors:['#f0e6d3','#c9a84c'] },
  { id:11, name:'Gold Fountain Pen',       cat:'Accessories', price:320, originalPrice:null, emoji:'üñäÔ∏è', badge:null,        desc:'18K gold nib, hand-tuned for buttery smooth writing. Solid brass body with a lacquered finish. Converter included.',                         colors:['#c9a84c','#1a1a1a'] },
  { id:12, name:'Cashmere Beanie',         cat:'Apparel',     price:110, originalPrice:null, emoji:'üß¢', badge:null,        desc:'Grade-A Mongolian cashmere, 2-ply knit. Pill-resistant and supremely soft. One size fits all.',                                               colors:['#c9a84c','#2d4a3e','#8b3a3a','#1a1a2e'] },
];

/* ================================================================
   2. STATE
================================================================ */
let cart = [];
let promoApplied = false;
let promoCode = null;
let currentProduct = null;
let checkoutStep = 1;
let currentPage = 'home';
let selectedPaymentMethod = 'card';
let currentOrderId = null;

/* ================================================================
   3. DATA LAYER ‚Äî EVENT FUNCTIONS
   Every meaningful user interaction fires a DL.push()
   Events follow GA4 Enhanced E-commerce spec:
   https://developers.google.com/analytics/devguides/collection/ga4/reference/events
================================================================ */

// ‚îÄ‚îÄ 3a. Navigation / Page Views ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_page_view(pageName) {
  DL.push({
    event: 'page_view',
    page_name: pageName,
    page_title: document.title,
    page_location: window.location.href + '#' + pageName,
    user_session_id: DL._sessionId
  });
}

// ‚îÄ‚îÄ 3b. Product Impressions (item_list_view) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_view_item_list(products, listName) {
  DL.push({
    event: 'view_item_list',
    ecommerce: {
      item_list_id: listName.toLowerCase().replace(/\s+/g, '_'),
      item_list_name: listName,
      items: products.map((p, i) => DL.productToItem(p, 1, i))
    }
  });
}

// ‚îÄ‚îÄ 3c. Product Detail View ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_view_item(product) {
  DL.push({
    event: 'view_item',
    ecommerce: {
      currency: 'USD',
      value: product.price,
      items: [DL.productToItem(product)]
    }
  });
}

// ‚îÄ‚îÄ 3d. Add to Cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_add_to_cart(product, qty) {
  DL.push({
    event: 'add_to_cart',
    ecommerce: {
      currency: 'USD',
      value: product.price * qty,
      items: [DL.productToItem(product, qty)]
    }
  });
}

// ‚îÄ‚îÄ 3e. Remove from Cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_remove_from_cart(product, qty) {
  DL.push({
    event: 'remove_from_cart',
    ecommerce: {
      currency: 'USD',
      value: product.price * qty,
      items: [DL.productToItem(product, qty)]
    }
  });
}

// ‚îÄ‚îÄ 3f. View Cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_view_cart() {
  const subtotal = getCartSubtotal();
  DL.push({
    event: 'view_cart',
    ecommerce: {
      currency: 'USD',
      value: subtotal,
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3g. Begin Checkout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_begin_checkout() {
  const subtotal = getCartSubtotal();
  DL.push({
    event: 'begin_checkout',
    ecommerce: {
      currency: 'USD',
      value: subtotal,
      coupon: promoApplied ? promoCode : undefined,
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3h. Checkout Step Progress ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_checkout_progress(step, stepName, option) {
  DL.push({
    event: 'checkout_progress',
    checkout_step: step,
    checkout_step_name: stepName,
    checkout_option: option || undefined,
    ecommerce: {
      currency: 'USD',
      value: getCartSubtotal(),
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3i. Add Payment Info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_add_payment_info(method) {
  DL.push({
    event: 'add_payment_info',
    ecommerce: {
      currency: 'USD',
      value: getCartSubtotal(),
      payment_type: method,
      coupon: promoApplied ? promoCode : undefined,
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3j. Add Shipping Info ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_add_shipping_info(tier) {
  DL.push({
    event: 'add_shipping_info',
    ecommerce: {
      currency: 'USD',
      value: getCartSubtotal(),
      shipping_tier: tier,
      coupon: promoApplied ? promoCode : undefined,
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3k. Purchase ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_purchase(orderId, subtotal, tax, shipping, coupon) {
  DL.push({
    event: 'purchase',
    ecommerce: {
      transaction_id: orderId,
      currency: 'USD',
      value: subtotal + tax + shipping,
      tax: tax,
      shipping: shipping,
      coupon: coupon || undefined,
      affiliation: 'LuxeMarket Online',
      items: DL.cartToItems(cart)
    }
  });
}

// ‚îÄ‚îÄ 3l. Promo Code Applied ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_promo_applied(code, discount, success) {
  DL.push({
    event: success ? 'select_promotion' : 'promotion_error',
    coupon_code: code,
    discount_value: discount,
    discount_pct: success ? 25 : 0
  });
}

// ‚îÄ‚îÄ 3m. Login / Register ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_login(method) {
  DL.push({ event: 'login', method });
}

function dl_sign_up(method) {
  DL.push({ event: 'sign_up', method });
}

// ‚îÄ‚îÄ 3n. Newsletter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_newsletter_subscribe(email) {
  DL.push({
    event: 'newsletter_subscribe',
    email_hash: btoa(email).substring(0, 12) + '...',   // Never log raw PII
    form_location: currentPage
  });
}

// ‚îÄ‚îÄ 3o. Search / Filter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_filter(filterType, filterValue, resultCount) {
  DL.push({
    event: 'filter_applied',
    filter_type: filterType,
    filter_value: filterValue,
    result_count: resultCount
  });
}

function dl_sort(sortValue, resultCount) {
  DL.push({
    event: 'sort_applied',
    sort_by: sortValue,
    result_count: resultCount
  });
}

// ‚îÄ‚îÄ 3p. Payment method selected ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_payment_select(method) {
  DL.push({ event: 'payment_method_selected', payment_method: method });
}

// ‚îÄ‚îÄ 3q. Outbound link click ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function dl_outbound_click(url, label) {
  DL.push({
    event: 'click',
    link_type: 'outbound',
    link_url: url,
    link_text: label,
    outbound: true
  });
}

/* ================================================================
   4. INSPECTOR PANEL UI HELPERS
================================================================ */
let dlPanelOpen = false;

function toggleDLPanel() {
  dlPanelOpen = !dlPanelOpen;
  const panel = document.getElementById('dl-panel');
  const hint  = document.getElementById('dl-hint');
  panel.style.display = dlPanelOpen ? 'flex' : 'none';
  hint.style.display  = dlPanelOpen ? 'none' : 'flex';
  if (dlPanelOpen) refreshDLState();
}

function clearDLLog() {
  document.getElementById('dl-tab-events').innerHTML = '';
  DL._eventCount = 0;
  document.getElementById('dl-event-count').textContent = '0 events';
  document.getElementById('dl-badge-count').textContent = '0';
}

function switchDLTab(tab, btn) {
  document.querySelectorAll('.dl-tab').forEach(b => { b.classList.remove('active'); b.style.borderBottomColor = 'transparent'; b.style.color = '#8b949e'; });
  document.querySelectorAll('.dl-tab-content').forEach(c => c.style.display = 'none');
  btn.classList.add('active');
  btn.style.borderBottomColor = '#c9a84c';
  btn.style.color = '#c9a84c';
  document.getElementById('dl-tab-' + tab).style.display = 'block';
  if (tab === 'state') refreshDLState();
  if (tab === 'cart')  refreshDLCart();
}

function refreshDLState() {
  const snap = {
    current_page: currentPage,
    session_id: DL._sessionId,
    total_events: DL._eventCount,
    cart_items: cart.length,
    cart_value: getCartSubtotal().toFixed(2),
    promo_applied: promoApplied,
    promo_code: promoCode,
    payment_method: selectedPaymentMethod,
    dataLayer_length: window.dataLayer.length
  };
  document.getElementById('dl-state-json').textContent = JSON.stringify(snap, null, 2);
}

function refreshDLCart() {
  document.getElementById('dl-cart-json').textContent = JSON.stringify(DL.cartToItems(cart), null, 2);
}

// Keyboard shortcut: Alt+D  ‚Üí  toggle inspector
document.addEventListener('keydown', e => { if (e.altKey && e.key === 'd') toggleDLPanel(); });

// Intercept outbound links to fire DL event
document.addEventListener('click', e => {
  const a = e.target.closest('a[href^="http"]');
  if (a && !a.href.includes(window.location.hostname)) {
    dl_outbound_click(a.href, a.textContent.trim());
  }
});

/* ================================================================
   5. CORE APP FUNCTIONS  (with data layer calls wired in)
================================================================ */

// ‚îÄ‚îÄ‚îÄ Page Navigation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showPage(name) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  const navEl = document.getElementById('nav-' + name);
  if (navEl) navEl.classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
  currentPage = name;

  // Page-specific actions
  if (name === 'cart') {
    renderCart();
    dl_view_cart();                      // GA4 view_cart
  }
  if (name === 'checkout') {
    renderCheckoutSummary();
    dl_begin_checkout();                 // GA4 begin_checkout
    dl_checkout_progress(1, 'Contact Information');
  }
  if (name === 'shop') {
    renderShopGrid(PRODUCTS);
    dl_view_item_list(PRODUCTS, 'Main Catalog');  // GA4 view_item_list
  }

  dl_page_view(name);                    // GA4 page_view for every nav
}

// ‚îÄ‚îÄ‚îÄ Render Product Cards ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderProductCard(p, target) {
  const card = document.createElement('div');
  card.className = 'product-card';
  card.innerHTML = `
    <div class="product-img">
      ${p.badge ? `<div class="product-badge">${p.badge}</div>` : ''}
      <span style="font-size:5rem;">${p.emoji}</span>
      <div class="product-overlay">
        <button class="quick-add" onclick="event.stopPropagation();addToCart(${p.id})">+ Add to Cart</button>
      </div>
    </div>
    <div class="product-info">
      <div class="product-category">${p.cat}</div>
      <div class="product-name">${p.name}</div>
      <div class="stars" style="margin-bottom:6px;">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
      <div class="product-price">$${p.price}${p.originalPrice ? `<del>$${p.originalPrice}</del>` : ''}</div>
    </div>`;
  card.onclick = () => openProductModal(p);
  document.getElementById(target).appendChild(card);
}

function renderFeatured() {
  const grid = document.getElementById('featured-grid');
  grid.innerHTML = '';
  const featured = PRODUCTS.slice(0, 4);
  featured.forEach(p => renderProductCard(p, 'featured-grid'));
  dl_view_item_list(featured, 'Featured Pieces');  // GA4 impression
}

function renderShopGrid(products) {
  const grid = document.getElementById('shop-grid');
  grid.innerHTML = '';
  document.getElementById('resultsCount').textContent = `${products.length} products`;
  products.forEach(p => renderProductCard(p, 'shop-grid'));
}

// ‚îÄ‚îÄ‚îÄ Filters & Sort ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function filterProducts() {
  let filtered = [...PRODUCTS];
  const maxPrice = parseInt(document.getElementById('priceRange').value);
  filtered = filtered.filter(p => p.price <= maxPrice);
  renderShopGrid(filtered);
  dl_filter('price', `max_$${maxPrice}`, filtered.length);
}

function updatePriceLabel(val) {
  document.getElementById('priceLabel').textContent = '$' + val;
  filterProducts();
}

function sortProducts(val) {
  let sorted = [...PRODUCTS];
  if (val === 'price-low')  sorted.sort((a, b) => a.price - b.price);
  if (val === 'price-high') sorted.sort((a, b) => b.price - a.price);
  if (val === 'newest')     sorted.reverse();
  renderShopGrid(sorted);
  dl_sort(val, sorted.length);
}

// ‚îÄ‚îÄ‚îÄ Product Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function openProductModal(p) {
  currentProduct = p;
  document.getElementById('modalImg').textContent = p.emoji;
  document.getElementById('modalCat').textContent = p.cat;
  document.getElementById('modalName').textContent = p.name;
  document.getElementById('modalPrice').textContent = '$' + p.price;
  document.getElementById('modalDesc').textContent = p.desc;
  document.getElementById('modalAddBtn').onclick = () => { addToCart(p.id); closeProductModal(); };

  const colorOpts = document.querySelector('.color-options');
  if (p.colors) {
    colorOpts.innerHTML = '';
    p.colors.forEach((c, i) => {
      const d = document.createElement('div');
      d.className = 'color-swatch' + (i === 0 ? ' active' : '');
      d.style.background = c;
      d.onclick = () => selectColor(d);
      colorOpts.appendChild(d);
    });
  }
  document.getElementById('productModal').classList.add('open');
  document.body.style.overflow = 'hidden';

  dl_view_item(p);   // GA4 view_item
}

function closeProductModal() {
  document.getElementById('productModal').classList.remove('open');
  document.body.style.overflow = '';
}

function closeModal(e) {
  if (e.target === document.getElementById('productModal')) closeProductModal();
}

function selectSize(btn) {
  document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  // Update selectedSize on currentProduct for variant tracking
  if (currentProduct) currentProduct.selectedSize = btn.textContent.trim();
  DL.push({ event: 'select_item_variant', variant_type: 'size', variant_value: btn.textContent.trim(), item_name: currentProduct ? currentProduct.name : null });
}

function selectColor(swatch) {
  swatch.closest('.color-options').querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
  swatch.classList.add('active');
  DL.push({ event: 'select_item_variant', variant_type: 'color', variant_value: swatch.style.background, item_name: currentProduct ? currentProduct.name : null });
}

// ‚îÄ‚îÄ‚îÄ Cart ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function addToCart(id) {
  const product = PRODUCTS.find(p => p.id === id);
  const existing = cart.find(c => c.id === id);
  if (existing) {
    existing.qty++;
  } else {
    cart.push({ ...product, qty: 1 });
  }
  updateCartCount();
  showToast(product.emoji, product.name, 'Added to your bag!');
  dl_add_to_cart(product, 1);   // GA4 add_to_cart
}

function removeFromCart(id) {
  const item = cart.find(c => c.id === id);
  if (item) dl_remove_from_cart(item, item.qty);   // GA4 remove_from_cart
  cart = cart.filter(c => c.id !== id);
  renderCart();
  updateCartCount();
}

function changeQty(id, delta) {
  const item = cart.find(c => c.id === id);
  if (!item) return;
  const oldQty = item.qty;
  item.qty = Math.max(1, item.qty + delta);
  if (delta > 0) dl_add_to_cart(item, delta);
  if (delta < 0 && item.qty > 0) dl_remove_from_cart(item, Math.abs(delta));
  renderCart();
}

function updateCartCount() {
  const total = cart.reduce((s, c) => s + c.qty, 0);
  document.getElementById('cartCount').textContent = total;
}

function getCartSubtotal() {
  return cart.reduce((s, c) => s + c.price * c.qty, 0);
}

function setQty(id, val) {
  const item = cart.find(c => c.id === id);
  if (!item) return;
  const newQty = Math.max(1, parseInt(val) || 1);
  const diff = newQty - item.qty;
  item.qty = newQty;
  if (diff > 0) dl_add_to_cart(item, diff);
  if (diff < 0) dl_remove_from_cart(item, Math.abs(diff));
  renderCart();
  updateCartCount();
}

function renderCart() {
  const container = document.getElementById('cart-items-container');
  const subtotal = getCartSubtotal();
  const tax = subtotal * 0.08;
  const discount = promoApplied ? subtotal * 0.25 : 0;
  const total = subtotal - discount + tax;

  document.getElementById('cart-subtitle').textContent = `${cart.reduce((s,c)=>s+c.qty,0)} items in your cart`;

  if (cart.length === 0) {
    container.innerHTML = `<div class="empty-cart" style="grid-column:1">
      <div class="big-icon">üõç</div>
      <h3>Your bag is empty</h3>
      <p>Looks like you haven't added anything yet.</p>
      <button class="btn-primary" onclick="showPage('shop')">Start Shopping</button>
    </div>`;
    document.getElementById('cart-summary-box').style.display = 'none';
    return;
  }

  document.getElementById('cart-summary-box').style.display = 'block';
  container.innerHTML = '';
  cart.forEach(item => {
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `
      <div class="cart-item-img">${item.emoji}</div>
      <div>
        <div class="cart-item-cat">${item.cat}</div>
        <div class="cart-item-name">${item.name}</div>
        <div class="cart-item-price">$${item.price}</div>
        <div class="qty-control">
          <button class="qty-btn" onclick="changeQty(${item.id},-1)">‚àí</button>
          <input class="qty-num" type="number" value="${item.qty}" min="1" onchange="setQty(${item.id},this.value)">
          <button class="qty-btn" onclick="changeQty(${item.id},+1)">+</button>
        </div>
      </div>
      <div class="cart-item-actions">
        <button class="remove-btn" onclick="removeFromCart(${item.id})">Remove</button>
        <div class="item-total">$${(item.price * item.qty).toFixed(2)}</div>
      </div>`;
    container.appendChild(div);
  });

  document.getElementById('summarySubtotal').textContent = `$${subtotal.toFixed(2)}`;
  document.getElementById('summaryShipping').textContent = subtotal > 150 ? 'Free' : '$9.99';
  document.getElementById('summaryTax').textContent = `$${tax.toFixed(2)}`;
  document.getElementById('summaryTotal').textContent = `$${total.toFixed(2)}`;
}

// ‚îÄ‚îÄ‚îÄ Promo Code ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function applyPromo() {
  const code = document.getElementById('promoInput').value.trim().toUpperCase();
  const msg = document.getElementById('promoMsg');
  if (code === 'LUXE25') {
    promoApplied = true;
    promoCode = 'LUXE25';
    msg.textContent = 'üéâ 25% discount applied!';
    msg.className = 'promo-msg good';
    dl_promo_applied(code, getCartSubtotal() * 0.25, true);   // GA4 select_promotion
    renderCart();
  } else if (code === '') {
    msg.textContent = 'Please enter a promo code.';
    msg.className = 'promo-msg bad';
  } else {
    promoApplied = false;
    promoCode = null;
    msg.textContent = 'Invalid code. Try LUXE25!';
    msg.className = 'promo-msg bad';
    dl_promo_applied(code, 0, false);   // promotion_error
  }
}

// ‚îÄ‚îÄ‚îÄ Checkout Summary ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function renderCheckoutSummary() {
  const container = document.getElementById('checkout-items');
  container.innerHTML = '';
  const subtotal = getCartSubtotal();
  const tax = subtotal * 0.08;
  cart.forEach(item => {
    container.innerHTML += `<div class="order-item">
      <div class="order-item-img">${item.emoji}</div>
      <div>
        <div class="order-item-name">${item.name}</div>
        <div class="order-item-qty">Qty: ${item.qty}</div>
      </div>
      <div class="order-item-price">$${(item.price * item.qty).toFixed(2)}</div>
    </div>`;
  });
  document.getElementById('co-subtotal').textContent = `$${subtotal.toFixed(2)}`;
  document.getElementById('co-tax').textContent = `$${tax.toFixed(2)}`;
  document.getElementById('co-total').textContent = `$${(subtotal + tax).toFixed(2)}`;
}

// ‚îÄ‚îÄ‚îÄ Place Order ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function placeOrder(e) {
  e.preventDefault();
  const orderId = 'LM-' + Math.floor(100000 + Math.random() * 900000);
  currentOrderId = orderId;
  document.getElementById('orderNumber').textContent = 'Order #' + orderId;

  const subtotal  = getCartSubtotal();
  const tax       = +(subtotal * 0.08).toFixed(2);
  const shipping  = subtotal > 150 ? 0 : 9.99;
  const coupon    = promoApplied ? promoCode : null;

  // GA4 purchase ‚Äî the most important ecom event
  dl_purchase(orderId, subtotal, tax, shipping, coupon);
  dl_checkout_progress(4, 'Order Confirmed', selectedPaymentMethod);

  cart = [];
  promoApplied = false;
  promoCode = null;
  updateCartCount();
  showPage('success');
}

// ‚îÄ‚îÄ‚îÄ Payment Method ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function selectPayment(el, type) {
  document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
  el.classList.add('selected');
  selectedPaymentMethod = type;
  document.getElementById('card-form').style.display    = type === 'card'   ? 'block' : 'none';
  document.getElementById('paypal-form').style.display  = type === 'paypal' ? 'block' : 'none';
  document.getElementById('apple-form').style.display   = type === 'apple'  ? 'block' : 'none';
  dl_payment_select(type);        // custom event
  dl_add_payment_info(type);      // GA4 add_payment_info
}

// ‚îÄ‚îÄ‚îÄ Card Format ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function formatCard(input) {
  let val = input.value.replace(/\D/g, '').substring(0, 16);
  input.value = val.replace(/(.{4})/g, '$1 ').trim();
}

// ‚îÄ‚îÄ‚îÄ Auth ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toggleAuthForm() {
  const si  = document.getElementById('signin-form-wrap');
  const reg = document.getElementById('register-form-wrap');
  const goingToRegister = si.style.display !== 'none';
  si.style.display  = goingToRegister ? 'none' : 'block';
  reg.style.display = goingToRegister ? 'block' : 'none';
  DL.push({ event: goingToRegister ? 'view_register_form' : 'view_login_form' });
}

function handleSignIn(e) {
  e.preventDefault();
  dl_login('email');           // GA4 login
  showToastMsg('Welcome back!', 'Signed in successfully.');
  showPage('home');
}

function handleRegister(e) {
  e.preventDefault();
  dl_sign_up('email');         // GA4 sign_up
  showToastMsg('Account Created!', 'Welcome to LuxeMarket.');
  showPage('home');
}

// ‚îÄ‚îÄ‚îÄ Newsletter ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function subscribeNewsletter(e) {
  e.preventDefault();
  const email = document.getElementById('nlEmail').value;
  dl_newsletter_subscribe(email);
  document.getElementById('nlSuccess').style.display = 'block';
  document.getElementById('nlEmail').value = '';
}

// ‚îÄ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
let toastTimer;
function showToast(emoji, title, sub) {
  clearTimeout(toastTimer);
  const t = document.getElementById('toast');
  t.querySelector('.toast-icon').textContent = emoji;
  document.getElementById('toastTitle').textContent = title;
  document.getElementById('toastSub').textContent = sub;
  t.classList.add('show');
  toastTimer = setTimeout(() => t.classList.remove('show'), 3000);
}
function showToastMsg(title, sub) { showToast('‚úÖ', title, sub); }

/* ================================================================
   6. INIT ‚Äî fire initial events on page load
================================================================ */
(function init() {
  // GA4 page_view for the landing page
  dl_page_view('home');

  // Render UI
  renderFeatured();
  renderShopGrid(PRODUCTS);

  // Fire initial item list impression for the hero grid
  // (already fires inside renderFeatured above)

  // Shipping radio buttons ‚Äî fire add_shipping_info on change
  document.querySelectorAll('input[name="shipping"]').forEach(radio => {
    radio.addEventListener('change', () => {
      const labelMap = { free: 'Standard Free', express: 'Express $12.99', overnight: 'Overnight $29.99' };
      dl_add_shipping_info(labelMap[radio.value] || radio.value);
      dl_checkout_progress(3, 'Shipping Method', radio.value);
    });
  });

  // Contact & shipping form field focus ‚Üí step tracking
  const step2Triggered = {};
  document.querySelectorAll('.checkout-form .form-input, .checkout-form .form-select').forEach((field, i) => {
    field.addEventListener('focus', () => {
      const sectionEl = field.closest('.form-section');
      if (!sectionEl) return;
      const stepNum = sectionEl.querySelector('.form-section-num');
      if (stepNum && !step2Triggered[stepNum.textContent]) {
        step2Triggered[stepNum.textContent] = true;
        if (stepNum.textContent === '1') dl_checkout_progress(1, 'Contact Information');
        if (stepNum.textContent === '2') dl_checkout_progress(2, 'Shipping Address');
      }
    });
  });

  console.log('%c[LuxeMarket] Data Layer initialized ‚úì', 'color:#c9a84c;font-size:1.1em;font-weight:bold;');
  console.log('%cPress Alt+D to open the Data Layer Inspector', 'color:#888;');
})();
</script>
</body>
</html>
